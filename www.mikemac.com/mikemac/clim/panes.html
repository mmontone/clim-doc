<html><head><title>CLIM: 29 Panes</title></head><body>
<br><table width=100%><tr valign="baseline">
<td width=25% align=left><a href="frames.html">Application Frames</a></td>
<td width=25% align=center><a href="toc.html">Contents</a></td>
<td width=25% align=center><a href="index.html">Index</a></td>
<td width=25% align=right><a href="gadgets.html">Gadgets</a></td>
</tr></table><br><hr><br>
<p>
<br><a name="29"><h1>29 Panes</h1></a>
<a name="LABEL=panes"></a> <a name="29.1"><h2>29.1 Overview of Panes</h2></a>
CLIM panes are similar to the gadgets or widgets of other toolkits.  They can be
used by application programmers to compose the top-level user interface of their
applications, as well as auxiliary components such as menus and dialogs.  The
application programmer provides an abstract specification of the pane hierarchy,
which CLIM uses in conjunction with user preferences and other factors to select
a specific ``look and feel'' for the application.  In many environments a CLIM
application can use the facilities of the host window system toolkit via a set
of <a name="CONCEPT=adaptive panes"><b><i>adaptive panes</i></b></a> , allowing a portable CLIM application to take on the
look and feel of a native application user interface.
<p>
Panes are rectangular objects that are implemented as special sheet classes.  An
application will typically construct a tree of panes that divide up the screen
space allocated to the application frame.  The various CLIM pane types can be
characterized by whether they have children panes or not: panes that can have
other panes as children are called <a name="CONCEPT=composite panes"><b><i>composite panes</i></b></a> , and those that
don't are called <a name="CONCEPT=leaf panes"><b><i>leaf panes</i></b></a> .  Composite panes are used to provide a
mechanism for spatially organizing (``laying out'') other panes.  Leaf panes
implement gadgets that have some appearance and react to user input by invoking
application code.  Another kind of leaf pane provides an area of the
application's screen real estate that can be used by the application to present
application specific information.  CLIM provides a number of these
<a name="CONCEPT=application pane"><b><i>application pane</i></b></a> types that allow the application to use CLIM's
graphics and extended stream facilities.
<p>
<a name="CONCEPT=Abstract panes"><b><i>Abstract panes</i></b></a> are panes that are defined only in terms of their
programmer interface, or behavior.  The protocol for an abstract pane (that is,
the specified set of initargs, accessors, and callbacks) is designed to specify
the pane in terms of its overall purpose, rather then in terms of its specific
appearance or particular interactive details.  The purpose of this abstract
definition is to allow multiple implementations of the abstract pane, each
defining its own specific look and feel.  CLIM can then select the appropriate
pane implementation based on factors outside the control of the application,
such as user preferences or the look and feel of the host operating environment.
A subset of the abstract panes, the <a href="panes.html#CONCEPT=adaptive panes"><i>adaptive panes</i></a> , have been defined to
integrate well across all CLIM operating platforms.
<p>
CLIM provides a general mechanism for automatically selecting the particular
implementation of an abstract pane selected by an application based on the
current frame manager.  The application programmer can override the selection
mechanism by using the name of a specific pane implementation in place of the
abstract pane name when specifying the application frame's layout.  By
convention, the name of the basic, portable implementation of an abstract pane
class can be determined by adding the suffix ``<tt>-pane</tt> '' to the name of the
abstract pane class.
<p>

<a name="29.2"><h2>29.2 Basic Pane Construction</h2></a>
Applications typically define the hierarchy of panes used in their frames using
the <tt>:pane</tt> or <tt>:panes</tt> options of <tt>define-application-frame</tt> .  These
options generate the body of methods on functions that are invoked when the
frame is being adopted into a particular frame manager, so the frame manager can
select the specific implementations of the abstract panes.
<p>
There are two basic interfaces to constructing a pane: <tt>make-pane</tt> of an
abstract pane class name, or <tt>make-instance</tt> of a ``concrete'' pane class.
The former approach is generally preferable, since it results in more portable
code.  However, in some cases the programmer may wish to instantiate panes of a
specific class (such as an <tt>hbox-pane</tt> or a <tt>vbox-pane</tt> ).  In this case,
using <tt>make-instance</tt> directly circumvents the abstract pane selection
mechanism.  However, the <tt>make-instance</tt> approach requires the application
programmer to know the name of the specific pane implementation class that is
desired, and so is inherently less portable.  By convention, all of the concrete
pane class names, including those of the implementations of abstract pane
protocol specifications, end in ``<tt>-pane</tt> ''.
<p>
Using <tt>make-pane</tt> instead of <tt>make-instance</tt> invokes the ``look and feel''
realization process to select and construct a pane.  Normally this process is
implemented by the frame manager, but it is possible for other ``realizers'' to
implement this process.  <tt>make-pane</tt> is typically invoked using an abstract
pane class name, which by convention is a symbol in the CLIM package that
doesn't include the ``<tt>-pane</tt> '' suffix.  (This naming convention
distinguishes the names of the abstract pane protocols from the names of classes
that implement them.)  Programmers, however, are allowed to pass any pane class
name to <tt>make-pane</tt> , in which case the frame manager will generally
instantiate that specific class.
<p>
<a name="Protocol&nbsp;Class pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Protocol&nbsp;Class]</b></td></tr></table>The protocol class that corresponds to a pane, a subclass of <tt>sheet</tt> .  A pane
is a special kind of sheet that implements the pane protocols, including the
layout protocols.
If you want to create a new class that behaves like a pane, it should be a subclass of <b>pane</b>. Subclasses of <b>pane</b> must obey the pane protocol.All of the subclasses of <tt>pane</tt> are mutable.
<p>
<a name="Predicate panep"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>panep</b></td><td valign="baseline" width="100%"><i>object</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Predicate]</b></td></tr></table>Returns <a href="panes.html#CONCEPT=true"><i>true</i></a> if <i>object</i> is a <a href="panes.html#CONCEPT=pane"><i>pane</i></a> , otherwise returns
<a href="panes.html#CONCEPT=false"><i>false</i></a> .
<p>
<a name="Class basic-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>basic-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Class]</b></td></tr></table>The basic class on which all CLIM panes are built, a subclass of <tt>pane</tt> .
<br><br><a name="Function make-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>make-pane</b></td><td valign="baseline" width="100%"><i>abstract-class-name <tt>&amp;rest</tt> initargs</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Selects a class that implements the behavior of the abstract pane
<i>abstract-class-name</i> and constructs a pane of that class.  <tt>make-pane</tt> must be used either within the scope of a call to
<tt>with-look-and-feel-realization</tt> , or within the <tt>:pane</tt> or <tt>:panes</tt> options of a <tt>define-application-frame</tt> (which implicitly invokes
<tt>with-look-and-feel-realization</tt> ).
<p>
It is permitted for this function to have lexical scope, and be defined only
within the body of <tt>with-look-and-feel-realization</tt> .
<p>

<a name="Generic function make-pane-1"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>make-pane-1</b></td><td valign="baseline" width="100%"><i>realizer frame abstract-class-name <tt>&amp;rest</tt> initargs</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>The generic function that is invoked by a call to <tt>make-pane</tt> .  The object
that realizes the pane, <i>realizer</i> , is established by
<tt>with-look-and-feel-realization</tt> .  Usually, <i>realizer</i> is a frame
manager, but it could be another object that implements the pane realization
protocol.  <i>frame</i> is the frame for which the pane will be created, and
<i>abstract-class-name</i> is the type of pane to create.
<p>
<a name="Macro with-look-and-feel-realization"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>with-look-and-feel-realization</b></td><td valign="baseline" width="100%"><i>(realizer frame) <tt>&amp;body</tt> forms</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>Establishes a dynamic context that installs <i>realizer</i> as the object
responsible for realizing panes.  All calls to <tt>make-pane</tt> within the context
of <tt>with-look-and-feel-realization</tt> result in <tt>make-pane-1</tt> being invoked
on <i>realizer</i> .  This macro can be nested dynamically; inner uses shadow
outer uses.  <i>body</i> may have zero or more declarations as its first forms.
<p>
Typically <i>realizer</i> is a frame manager, but in some cases <i>realizer</i> may be some other object.  For example, within the implementation of pane that
is uses its own subpanes to achieve its functionality, this form might be used
with <i>realizer</i> being the pane itself.
<p>

<a name="LABEL=pane-init"></a> 
<a name="29.2.1"><h3>29.2.1 Pane Initialization Options </h3></a>
The following options must be accepted by all pane classes.
<p>
<a name="Option :foreground"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:foreground</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :background"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:background</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>These options specify the default foreground and background inks for a pane.
These will normally default from window manager resources.  If there are no such
resources, the defaults are black and white, respectively.
<p>
Client code should be cautious about passing values for these two options, since
the window manager's look and feel or the user's preferences should usually
determine these values.
<p>
<a name="Option :text-style"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:text-style</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>This option specifies the default text style that should be used for any sort of
pane that supports text output.  Panes that do not support text output ignore
this option.
<p>
Client code should be cautious about passing values for this option, since the
window manager's look and feel or the user's preferences should usually
determine this value.
<p>
<a name="Option :name"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:name</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>This option specifies the name of the pane.  It defaults to <tt>nil</tt> .
<p>

<a name="29.2.2"><h3>29.2.2 Pane Properties</h3></a>
<a name="Generic function pane-frame"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>pane-frame</b></td><td valign="baseline" width="100%"><i>pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Returns the frame that ``owns'' the pane.  <tt>pane-frame</tt> can be invoked on any
pane in a frame's pane hierarchy, but it can only be invoked on ``active''
panes, that is, those panes that are currently adopted into the frame's pane
hierarchy.
<p>
<a name="Generic function pane-name"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>pane-name</b></td><td valign="baseline" width="100%"><i>pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Returns the name of the pane.
<p>
<a name="Generic function pane-foreground"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>pane-foreground</b></td><td valign="baseline" width="100%"><i>pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table><a name="Generic function pane-background"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>pane-background</b></td><td valign="baseline" width="100%"><i>pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table><a name="Generic function pane-text-style"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>pane-text-style</b></td><td valign="baseline" width="100%"><i>pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Return the default foreground and background inks and the default text style,
respectively, for the pane <i>pane</i> .  These will be used as the default value
for <tt>medium-foreground</tt> and <tt>medium-background</tt> when a medium is grafted
to the pane.
<p>

<a name="29.3"><h2>29.3 Composite and Layout Panes</h2></a>
This section describes the various composite and layout panes provided by CLIM,
and the protocol that the layout panes obey.
<p>
The layout panes describe in this section are all composite panes that are
responsible for positioning their children according to various layout rules.
Layout panes can be selected in the same way as other panes using <tt>make-pane</tt> or <tt>make-instance</tt> .  For convenience and readability of application pane
layouts, many of these panes also provide a macro that expands into a
<tt>make-pane</tt> form, passing a list of the panes created in the body of the
macro as the <tt>:contents</tt> argument (described below).  For example, you can
express a layout of a vertical column of two label panes either as:
<p>
<pre>(make-instance 'vbox-pane
  :contents (list (make-instance 'label-pane :text "One")
                  (make-instance 'label-pane :text "Two")))
</pre> or as:
<p>
<pre>(vertically ()
  (make-instance 'label-pane :text "One")
  (make-instance 'label-pane :text "Two"))
</pre> <a name="29.3.1"><h3>29.3.1 Layout Pane Options</h3></a>
<a name="Option :contents"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:contents</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>All of the layout pane classes accept the <tt>:contents</tt> options, which is used
to specify the child panes to be laid out.
<p>
<a name="Option :width"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:width</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :max-width"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:max-width</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :min-width"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:min-width</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :height"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:height</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :max-height"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:max-height</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :min-height"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:min-height</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>These options control the space requirement paramaters for laying out the pane.
The <tt>:width</tt> and <tt>:height</tt> options specify the preferred horizontal and
vertical sizes.  The <tt>:max-width</tt> and <tt>:max-height</tt> options specify the
maximum amount of space that may be consumed by the pane, and give CLIM's pane
layout engine permission to grow the pane beyond the preferred size.  The
<tt>:min-width</tt> and <tt>:min-height</tt> options specify the minimum amount of space
that may be consumed by the pane, and give CLIM's pane layout engine permission
to shrink the pane below the preferred size.
<p>
If either of the <tt>:max-width</tt> or <tt>:min-width</tt> options is not supplied, it
defaults to the value of the <tt>:width</tt> option.  If either of the
<tt>:max-height</tt> or <tt>:min-height</tt> options is not supplied, it defaults to the
value of the <tt>:height</tt> option.
<p>
<tt>:max-width</tt> , <tt>:min-width</tt> , <tt>:max-height</tt> , and <tt>:min-height</tt> can
also be specified as a relative size by supplying a list of the form
<tt>(<i>number</i> :relative)</tt> .  In this case, the number indicates the number
of device units that the pane is willing to stretch or shrink.
<p>
The values of these options are specified in the same way as the <tt>:x-spacing</tt> and <tt>:y-spacing</tt> options to <tt>formatting-table</tt> .  (Note that
<tt>:character</tt> and <tt>:line</tt> may only be used on those panes that display
text, such as a <tt>clim-stream-pane</tt> or a <tt>label-pane</tt> .)
<p>
<a name="Constant +fill+"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>+fill+</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Constant]</b></td></tr></table>This constant can be used as a value to any of the relative size options.  It
indicates that pane's willingness to adjust an arbitrary amount in the specified
direction.
<p>
<a name="Option :align-x"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:align-x</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :align-y"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:align-y</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>The <tt>:align-x</tt> option is one of <tt>:right</tt> , <tt>:center</tt> , or <tt>:left</tt> .
The <tt>:align-y</tt> option is one of <tt>:top</tt> , <tt>:center</tt> , or <tt>:bottom</tt> .
These are used to specify how child panes are aligned within the parent pane.
These have the same semantics as for <tt>formatting-cell</tt> .
<p>
<a name="Option :x-spacing"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:x-spacing</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :y-spacing"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:y-spacing</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :spacing"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:spacing</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>These spacing options apply to <tt>hbox-pane</tt> , <tt>vbox-pane</tt> , <tt>table-pane</tt> ,
and <tt>grid-pane</tt> , and indicate the amount of horizontal and vertical spacing
(respectively) to leave between the items in boxes or rows and columns in table.
The values of these options are specified in the same way as the <tt>:x-spacing</tt> and <tt>:y-spacing</tt> options to <tt>formatting-table</tt> .  <tt>:spacing</tt> specifies
both the <tt>x</tt> and <tt>y</tt> spacing simultaneously.
<p>

<a name="29.3.2"><h3>29.3.2 Layout Pane Classes</h3></a>
<a name="Layout Pane hbox-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>hbox-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table><a name="Macro horizontally"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>horizontally</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;rest</tt> options <tt>&amp;key</tt> spacing <tt>&amp;allow-other-keys</tt> ) <tt>&amp;body</tt> contents</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>The <tt>hbox-pane</tt> class lays out all of its child panes horizontally, from left
to right.  The child panes are separated by the amount of space specified by
<i>spacing</i> .
<p>
The <tt>horizontally</tt> macro serves as a convenient interface for creating an
<tt>hbox-pane</tt> .
<p>
<i>contents</i> is one or more forms that are the child panes.  Each form in
<i>contents</i> is of the form:
<p>
<ul> <li> A pane.  The pane is inserted at this point and its space requirements are
used to compute the size.
<p>
<li> A number.  The specified number of device units should be allocated at
this point.
<p>
<li> The symbol <tt>+fill+</tt> .  This means that an arbitrary amount of space can
be absorbed at this point in the layout.
<p>
<li> A list whose first element is a number and whose second element evaluates
to a pane.  If the number is less than 1, then it means that that percentage of
excess space or deficit should be allocated to the pane.  If the number is
greater than or equal to 1, then that many device units are allocated to the
pane.  For example:
<p>
<pre>(horizontally ()
  (1/3 (make-pane 'label-button-pane))
  (2/3 (make-pane 'label-button-pane)))
</pre> would create a horizontal stack of two button panes.  The first button takes
one-third of the space, then second takes two-thirds of the space.
</ul> <a name="Layout Pane vbox-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>vbox-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table><a name="Macro vertically"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>vertically</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;rest</tt> options <tt>&amp;key</tt> spacing <tt>&amp;allow-other-keys</tt> ) <tt>&amp;body</tt> contents</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>The <tt>vbox-pane</tt> class lays out all of its child panes vertically, from top to
bottom.  The child panes are separated by the amount of space specified by
<i>spacing</i> .
<p>
The <tt>vertically</tt> macro serves as a convenient interface for creating an
<tt>vbox-pane</tt> .
<p>
<i>contents</i> is as for <tt>horizontally</tt> .
<p>

<a name="Layout Pane hrack-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>hrack-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table><a name="Layout Pane vrack-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>vrack-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table>Similar to the <tt>hbox-pane</tt> and <tt>vbox-pane</tt> classes, except that these
ensure that all children are the same size in the minor dimension.  In other
words, these panes are used to create stacks of same-sized items, such as menu
items.
<p>
An <tt>hrack-pane</tt> is created when the <tt>:equalize-height</tt> option to
<tt>horizontally</tt> is <a href="panes.html#CONCEPT=true"><i>true</i></a> .  A <tt>vrack-pane</tt> is created when the
<tt>:equalize-width</tt> option to <tt>vertically</tt> is <a href="panes.html#CONCEPT=true"><i>true</i></a> .
<p>

<a name="Layout Pane table-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>table-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table><a name="Macro tabling"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>tabling</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;rest</tt> options) <tt>&amp;body</tt> contents</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>This pane lays out its child panes in a two-dimensional table arrangement.  Each
of the table is specified by an extra level of list in <i>contents</i> .  For example,
<p>
<pre>(tabling ()
  (list
    (make-pane 'label :text "Red")
    (make-pane 'label :text "Green")
    (make-pane 'label :text "Blue"))
  (list
    (make-pane 'label :text "Intensity")
    (make-pane 'label :text "Hue")
    (make-pane 'label :text "Saturation")))
</pre> <a name="Layout Pane grid-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>grid-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table>A <tt>grid-pane</tt> is like a <tt>table-pane</tt> , except that each cell is the same
size in each of the two dimensions.
<p>

<a name="Layout Pane spacing-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>spacing-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table><a name="Macro spacing"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>spacing</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;rest</tt> options <tt>&amp;key</tt> thickness <tt>&amp;allow-other-keys</tt> ) <tt>&amp;body</tt> contents</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>This pane reserves some margin space of thickness <i>thickness</i> around a
single child pane.  The space requirement keys that are passed in indicate the
requirements for the surrounding space, not including the requirements of the
child.
<p>

<a name="Layout Pane outlined-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>outlined-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table><a name="Macro outlining"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>outlining</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;rest</tt> options <tt>&amp;key</tt> thickness <tt>&amp;allow-other-keys</tt> ) <tt>&amp;body</tt> contents</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>This layout pane puts a outline of thickness <i>thickness</i> around its contents.
<p>
The <tt>:background</tt> option can be used to control the ink used to draw the
background.
<p>

<a name="Layout Pane restraining-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>restraining-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table><a name="Macro restraining"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>restraining</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;rest</tt> options) <tt>&amp;body</tt> contents</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>Wraps the contents with a pane that prevents changes to the space requirements
for contents from causing relayout of panes outside of the restraining context.
In other words, it prevents the size constraints of the child from propagating
up beyond this point.
<p>

<a name="Layout Pane bboard-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>bboard-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Layout Pane]</b></td></tr></table>A pane that allows its children to be any size and lays them out wherever they
want to be (for example, a desktop manager).
<p>

<a name="Service Pane label-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>label-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Service Pane]</b></td></tr></table><a name="Macro labelling"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>labelling</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;rest</tt> options <tt>&amp;key</tt> label label-alignment <tt>&amp;allow-other-keys</tt> )
                       <tt>&amp;body</tt> contents</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>Creates a pane that consists of the specified label <i>label</i> , which is a
string.  <i>label-alignment</i> may be either <tt>:bottom</tt> or <tt>:top</tt> , which
specifies whether the label should appear at the top or the bottom of the
labelled pane.  The default for <i>label-alignment</i> is left unspecified.
<p>

<a name="29.3.3"><h3>29.3.3 Scroller Pane Classes</h3></a>
CLIM defines the following additional pane classes, each having at least one
implementation.
<p>
<a name="Service Pane scroller-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>scroller-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Service Pane]</b></td></tr></table><a name="Macro scrolling"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>scrolling</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;rest</tt> options) <tt>&amp;body</tt> contents</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>Creates a composite pane that allows the single child specified by
<i>contents</i> to be scrolled.  <i>options</i> may include a <tt>:scroll-bar</tt> option.  The value of this option may be <tt>t</tt> (the default), which indicates
that both horizontal and vertical scroll bars should be created; <tt>:vertical</tt> ,
which indicates that only a vertical scroll bar should be created; or
<tt>:horizontal</tt> , which indicates that only a horizontal scroll bar should be
created.
<p>
The pane created by the <tt>scrolling</tt> will include a <tt>scroller-pane</tt> that
has as children the scroll bars and a <a name="CONCEPT=viewport"><b><i>viewport</i></b></a> .  The viewport of a
pane is the area of the window's drawing plane that is currently visible to the
user.  The viewport has as its child the specified contents.
<p>
<a name="Generic function pane-viewport"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>pane-viewport</b></td><td valign="baseline" width="100%"><i>pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>If the pane <i>pane</i> is part of a scroller pane, this returns the viewport
pane for <i>pane</i> .  Otherwise it returns <tt>nil</tt> .
<p>
<a name="Generic function pane-viewport-region"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>pane-viewport-region</b></td><td valign="baseline" width="100%"><i>pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>If the pane <i>pane</i> is part of a scroller pane, this returns the region of
the pane's viewport.  Otherwise it returns <tt>nil</tt> .
<p>
<a name="Generic function pane-scroller"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>pane-scroller</b></td><td valign="baseline" width="100%"><i>pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>If the pane <i>pane</i> is part of a scroller pane, this returns the scroller
pane itself.  Otherwise it returns <tt>nil</tt> .
<p>
<a name="Generic function scroll-extent"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>scroll-extent</b></td><td valign="baseline" width="100%"><i>pane x y</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>If the pane <i>pane</i> is part of a scroller pane, this scrolls the pane in its
viewport so that the position <tt>(x,y)</tt> of <i>pane</i> is at the upper-left corner
of the viewport.  Otherwise, it does nothing.
<p>
<i>x</i> and <i>y</i> are coordinates.
<p>

<a name="LABEL=layout-protocol"></a> 
<a name="29.3.4"><h3>29.3.4 The Layout Protocol</h3></a>
The layout protocol is triggered by <tt>layout-frame</tt> , which is called when a
frame is adopted by a frame manager.
<p>
CLIM uses a two pass algorithm to lay out a pane hierarchy.  In the first pass
(called called <a name="CONCEPT=space composition"><b><i>space composition</i></b></a> ), the top-level pane is asked how
much space it requires.  This may in turn lead to same the question being asked
recursively of all the panes in the hierarchy, with the answers being composed
to produce the top-level pane's answer.  Each pane answers the query by
returning a <a name="CONCEPT=space requirement"><b><i>space requirement</i></b></a> (or <tt>space-requirement</tt> ) object,
which specifies the pane's desired width and height as well as its willingness
to shrink or grow along its width and height.
<p>
In the second pass (called <a name="CONCEPT=space allocation"><b><i>space allocation</i></b></a> ), the frame manager
attempts to obtain the required amount of space from the host window system.
The top-level pane is allocated the space that is actually available.  Each
pane, in turn, allocates space recursively to each of its descendants in the
hierarchy according to the pane's rules of composition.
<p>
<hr><b>Issue:</b> ILA<br><i>It isn't alway possible to allocate the required space.  What is
the protocol for handling these space allocation failures?  Some kind of error
should be signalled when the constraints can't be satisfied, which can be
handled by the application.  Otherwise the panes will fall where they may.  The
<tt>define-application-frame</tt> macro should provide an option that allows
programmers to conveniently specify a condition handler.</i><hr>
For many types of panes, the application programmer can indicate the space
requirements of the pane at creation time by using the space requirement options
(described above), as well as by calling the <tt>change-space-requirements</tt> function (described below).  For example, application panes are used to display
application-specific information, so the application can determine how much
space should normally be given to them.
<p>
Other pane types automatically calculate how much space they need based on the
information they need to display.  For example, label panes automatically
calculate their space requirement based on the text they need to display.
<p>
A composite pane calculates its space requirement based on the requirements of
its children and its own particular rule for arranging them.  For example, a
pane that arranges its children in a vertical stack would return as its desired
height the sum of the heights of its children.  Note however that a composite is
not required by the layout protocol to respect the space requests of its
children; in fact, composite panes aren't even required to ask their children.
<p>
Space requirements are expressed for each of the two dimensions as a preferred
size, a mininum size below which the pane cannot be shrunk, and a maxium size
above which the pane cannot be grown.  (The minimum and maximum sizes can also
be specified as relative amounts.)  All sizes are specified as a real number
indicating the number of device units (such as pixels).
<p>

<a name="Class space-requirement"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>space-requirement</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Class]</b></td></tr></table>The protocol class of all space requirement objects.  There are one or more
subclasses of <tt>space-requirement</tt> with implementation-dependent names that
implement space requirements.  The exact names of these classes is explicitly
unspecified.  
If you want to create a new class that behaves like a space requirement, it should be a subclass of <b>space-requirement</b>. Subclasses of <b>space-requirement</b> must obey the space requirement protocol.All of the instantiable space requirement classes provided by CLIM are
immutable.
<p>

<a name="Function make-space-requirement"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>make-space-requirement</b></td><td valign="baseline" width="100%"><i><tt>&amp;key</tt> (width <tt>0</tt> ) (max-width <tt>0</tt> ) (min-width <tt>0</tt> )
                                      (height <tt>0</tt> ) (max-height <tt>0</tt> ) (min-height <tt>0</tt> )</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Constructs a space requirement object with the given characteristics, <tt>:width</tt> ,
<tt>:height</tt> , and so on.
<p>
<a name="Generic function space-requirement-width"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement-width</b></td><td valign="baseline" width="100%"><i>space-req</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table><a name="Generic function space-requirement-min-width"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement-min-width</b></td><td valign="baseline" width="100%"><i>space-req</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table><a name="Generic function space-requirement-max-width"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement-max-width</b></td><td valign="baseline" width="100%"><i>space-req</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table><a name="Generic function space-requirement-height"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement-height</b></td><td valign="baseline" width="100%"><i>space-req</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table><a name="Generic function space-requirement-min-height"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement-min-height</b></td><td valign="baseline" width="100%"><i>space-req</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table><a name="Generic function space-requirement-max-height"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement-max-height</b></td><td valign="baseline" width="100%"><i>space-req</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>These functions read the components of the space requirement <i>space-req</i> .
<p>
<a name="Generic function space-requirement-components"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement-components</b></td><td valign="baseline" width="100%"><i>space-req</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Returns the components of the space requirement <i>space-req</i> as six values,
the width, minimum width, maximum width, height, minimum height, and maximum
height.
<p>
<a name="Function space-requirement-combine"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement-combine</b></td><td valign="baseline" width="100%"><i>function sr1 sr2</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Returns a new space requirement each of whose components is the result of
applying the function <i>function</i> to each the components of the two space
requirements <i>sr1</i> and <i>sr2</i> .
<p>
<i>function</i> is a function of two arguments, both of which are real numbers.
It has dynamic extent.
<p>
<a name="Function space-requirement+"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement+</b></td><td valign="baseline" width="100%"><i>sr1 sr2</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Returns a new space whose components are the sum of each of the components of
<i>sr1</i> and <i>sr2</i> .  This could be implemented as follows:
<p>
<pre>(defun space-requirement+ (sr1 sr2)
  (space-requirement-combine #'+ sr1 sr2))
</pre> <a name="Function space-requirement+*"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>space-requirement+*</b></td><td valign="baseline" width="100%"><i>space-req <tt>&amp;key</tt> width min-width max-width
                                             height min-height max-height</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Returns a new space requirement whose components are the sum of each of the
components of <i>space-req</i> added to the appropriate keyword argument (for
example, the width component of <i>space-req</i> is added to <i>width</i> ).
<p>
This is intended to be a more efficient, ``spread'' version of
<tt>space-requirement+</tt> .
<p>

<a name="Generic function compose-space"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>compose-space</b></td><td valign="baseline" width="100%"><i>pane <tt>&amp;key</tt> width height</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>During the space composition pass, a composite pane will typically ask each of
its children how much space it requires by calling <tt>compose-space</tt> .  They
answer by returning <tt>space-requirement</tt> objects.  The composite will then
form its own space requirement by composing the space requirements of its
children according to its own rules for laying out its children.
<p>
The value returned by <tt>compose-space</tt> is a space requirement object that
represents how much space the pane <i>pane</i> requires.
<p>
<i>width</i> and <i>height</i> are real numbers that the <tt>compose-space</tt> method
for a pane may use as ``recommended'' values for the width and height of the
pane.  These are used to drive top-down layout.
<p>
<a name="Generic function allocate-space"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>allocate-space</b></td><td valign="baseline" width="100%"><i>pane width height</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>During the space allocation pass, a composite pane will arrange its children
within the available space and allocate space to them according to their space
requirements and its own composition rules by calling <tt>allocate-space</tt> on
each of the child panes.  <i>width</i> and <i>height</i> are the width and height
of <i>pane</i> in device units.
<p>

<a name="Generic function change-space-requirements"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>change-space-requirements</b></td><td valign="baseline" width="100%"><i>pane <tt>&amp;key</tt> resize-frame <tt>&amp;rest</tt> space-req-keys</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>This function can be invoked to indicate that the space requirements for
<i>pane</i> have changed.  Any of the options that applied to the pane at
creation time can be passed into this function as well.
<p>
<i>resize-frame</i> determines whether the frame should be resized to accommodate
the new space requirement of the hierarchy.  If <i>resize-frame</i> is
<a href="panes.html#CONCEPT=true"><i>true</i></a> , then <tt>layout-frame</tt> will be invoked on the frame.  If
<i>resize-frame</i> is <a href="panes.html#CONCEPT=false"><i>false</i></a> , then the frame may or may not get resized
depending on the pane hierarchy and the <tt>:resize-frame</tt> option that was
supplied to <tt>define-application-frame</tt> .
<p>
<a name="Generic function note-space-requirements-changed"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>note-space-requirements-changed</b></td><td valign="baseline" width="100%"><i>sheet pane</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>This function is invoked whenever <i>pane</i> 's space requirements have changed.
<i>sheet</i> must be the parent of <i>pane</i> .  Invoking this function
essentially means that <i>compose-space</i> will be reinvoked on <i>pane</i> , then
it will reply with a space requirement that is not equal to the reply that was
given on the last call to <i>compose-space</i> .
<p>
This function is automatically invoked by <tt>change-space-requirements</tt> in the
cases that <tt>layout-frame</tt> isn't invoked.  In the case that <tt>layout-frame</tt> is invoked, it isn't necessary to call <tt>note-space-requirements-changed</tt> since a complete re-layout of the frame will be executed.
<p>
<a name="Macro changing-space-requirements"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>changing-space-requirements</b></td><td valign="baseline" width="100%"><i>(<tt>&amp;key</tt> resize-frame layout) <tt>&amp;body</tt> body</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Macro]</b></td></tr></table>This macro supports batching the invocation of the layout protocol by calls
to <tt>change-space-requirements</tt> .  Within the body, all calls to
<tt>change-space-requirements</tt> change the internal structures of the pane and
are recorded.  When the body is exited, the layout protocol is invoked
appropriately.  <i>body</i> may have zero or more declarations as its first
forms.
<p>

<a name="LABEL=clim-panes"></a> 
<a name="29.4"><h2>29.4 CLIM Stream Panes</h2></a>
In addition to the various layout panes and gadgets, an application usually
needs some space to display application-specific output and receive
application-specific input from the user.  For example, a paint program needs a
``canvas'' pane on which to display the picture and handle the ``mouse
strokes''.  An application frame can use the basic CLIM input and output
services in an application-specific way through use of a <a name="CONCEPT=CLIM stream pane"><b><i>CLIM stream pane</i></b></a> .
<p>
This section describes the basic CLIM stream pane types.  Programmers are
free to customize pane behavior by defining subclasses of these pane classes
writing methods to change the repaint or event-handling behavior.
<p>

<a name="LABEL=clim-pane-options"></a> 
<a name="29.4.1"><h3>29.4.1 CLIM Stream Pane Options</h3></a>
CLIM application frames accept the <tt>:foreground</tt> , <tt>:background</tt> ,
<tt>:text-style</tt> , and layout pane options.  The space requirement options
(<tt>:width</tt> , <tt>:height</tt> , and so forth) can also take a size specification of
<tt>:compute</tt> , which causes CLIM to run the display function for the pane, and
make the pane large enough to hold the output of the display function.
<p>
In addition to the above, CLIM stream panes accept the following options:
<p>
<a name="Option :display-function"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:display-function</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>This is used to specify a function to be called in order to display the contents
of a CLIM stream pane.  CLIM's default top level function,
<tt>default-frame-top-level</tt> , function will invoke the pane's display function
at the appropriate time (see the <tt>:display-time</tt> option).  The value of this
option is either the name of a function to invoke, or a cons whose car is the
name of a function and whose cdr is additional arguments to the function.  The
function will be invoked on the frame, the pane, and the additional function
arguments, if any.  The default for this option is <tt>nil</tt> .
<p>
<a name="Option :display-time"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:display-time</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>This is used to indicate to CLIM when the pane's display function should be run.
If it is <tt>:command-loop</tt> , CLIM will clear the pane and run the display
function after each time a frame command is executed.  If it is <tt>t</tt> , the pane
will be displayed once and not again until <tt>(setf~pane-needs-redisplay)</tt> is
called on the pane.  If it is <tt>nil</tt> , CLIM will never run the display function
until it is explicitly requested, either via <tt>pane-needs-redisplay</tt> or
<tt>redisplay-frame-pane</tt> .  The default for this option varies depending on the
type of the pane.
<p>
<a name="Option :incremental-redisplay"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:incremental-redisplay</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>When <a href="panes.html#CONCEPT=true"><i>true</i></a> , the redisplay function will initially be executed inside of an
invocation to <tt>updating-output</tt> and the resulting output record will be
saved.  Subsequent calls to <tt>redisplay-frame-pane</tt> will simply use
<tt>redisplay</tt> to redisplay the pane.  The default for this option is <tt>nil</tt> .
<p>
<a name="Option :text-margin"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:text-margin</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :vertical-spacing"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:vertical-spacing</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>These options specify the default text margin (that is, how much space is left
around the inside edge of the pane) and vertical spacing (that is, how much space
is between each text line) for the pane.  The default for <tt>:text-margin</tt> is
the width of the window, and the default for <tt>:vertical-spacing</tt> is 2.
<p>

<a name="Option :end-of-line-action"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:end-of-line-action</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :end-of-page-action"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:end-of-page-action</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>These options specify the end-of-line and end-of-page actions to be used for the
pane.  The default for these options are <tt>:wrap</tt> and <tt>:scroll</tt> ,
respectively.
<p>
<a name="Option :output-record"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:output-record</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>This option names the output record class to be used for the output history of
the pane.  The default is <tt>standard-tree-output-history</tt> .
<p>
<a name="Option :draw"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:draw</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table><a name="Option :record"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>:record</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Option]</b></td></tr></table>These options specify whether the pane should initially allow drawing and output
recording.  The default for both options is <tt>t</tt> .
<p>

<a name="29.4.2"><h3>29.4.2 CLIM Stream Pane Classes</h3></a>
<a name="Service Pane clim-stream-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>clim-stream-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Service Pane]</b></td></tr></table>This class implements a pane that supports the CLIM graphics, extended input and
output, and output recording protocols.  Most CLIM stream panes will be
subclasses of this class.
<p>
<a name="Service Pane interactor-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>interactor-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Service Pane]</b></td></tr></table>The pane class that is used to implement ``interactor'' panes.  The default
method for <tt>frame-standard-input</tt> will return the first pane of this type.
<p>
For <tt>interactor-pane</tt> , the default for <tt>:display-time</tt> is <tt>nil</tt> and the
default for <tt>:scroll-bars</tt> is <tt>:vertical</tt> .
<p>
<a name="Service Pane application-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>application-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Service Pane]</b></td></tr></table>The pane class that is used to implement ``application'' panes.  The default
method for <tt>frame-standard-output</tt> will return the first pane of this type.
<p>
For <tt>application-pane</tt> , the default for <tt>:display-time</tt> is
<tt>:command-loop</tt> and the default for <tt>:scroll-bars</tt> is <tt>t</tt> .
<p>
<a name="Service Pane command-menu-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>command-menu-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Service Pane]</b></td></tr></table>The pane class that is used to implement command menu panes that are not menu
bars.  The default display function for panes of this type is
<tt>display-command-menu</tt> .
<p>
For <tt>command-menu-pane</tt> , the default for <tt>:display-time</tt> is
<tt>:command-loop</tt> , the default for <tt>:incremental-redisplay</tt> is <tt>t</tt> , and
the default for <tt>:scroll-bars</tt> is <tt>t</tt> .
<p>
<a name="Service Pane title-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>title-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Service Pane]</b></td></tr></table>The pane class that is used to implement a title pane.  The default display
function for panes of this type is <tt>display-title</tt> .
<p>
For <tt>title-pane</tt> , the default for <tt>:display-time</tt> is <tt>t</tt> and the
default for <tt>:scroll-bars</tt> is <tt>nil</tt> .
<p>
<a name="Service Pane pointer-documentation-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="100%"><b>pointer-documentation-pane</b></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Service Pane]</b></td></tr></table>The pane class that is used to implement the pointer documentation pane.
<p>
For <tt>pointer-documentation-pane</tt> , the default for <tt>:display-time</tt> is
<tt>nil</tt> and the default for <tt>:scroll-bars</tt> is <tt>nil</tt> .
<p>

<a name="29.4.3"><h3>29.4.3 Making CLIM Stream Panes</h3></a>
Most CLIM stream panes will contain more information than can be displayed
in the allocated space, so scroll bars are nearly always desirable.  CLIM
therefore provides a convenient form for creating composite panes that include
the CLIM stream pane, scroll bars, labels, and so forth.
<p>
<a name="Function make-clim-stream-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>make-clim-stream-pane</b></td><td valign="baseline" width="100%"><i><tt>&amp;rest</tt> options 
                                <tt>&amp;key</tt> type label label-alignment scroll-bars borders
                                     display-after-commands <tt>&amp;allow-other-keys</tt> </i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Creates a pane of type <i>type</i> , which defaults to <tt>clim-stream-pane</tt> .
<p>
If <i>label</i> is supplied, it is a string used to label the pane.
<i>label-alignment</i> is as for the <tt>labelling</tt> macro.
<p>
<i>scroll-bars</i> may be <tt>t</tt> to indicate that both vertical and horizontal
scroll bars should be included, <tt>:vertical</tt> (the default) to indicate that
vertical scroll bars should be included, or <tt>:horizontal</tt> to indicate that
horizontal scroll bars should be included.
<p>
If <i>borders</i> is <a href="panes.html#CONCEPT=true"><i>true</i></a> , the default, a border is drawn around the pane.
<p>
<i>display-after-commands</i> is used to initialize the <tt>:display-time</tt> property of the pane.  It may be <tt>t</tt> (for <tt>:display-time :command-loop</tt> ),
<tt>:no-clear</tt> (for <tt>:display-time :no-clear</tt> ), or <tt>nil</tt> (for
<tt>:display-time nil</tt> ).
<p>
The other options may include all of the valid CLIM stream pane options.
<p>
<a name="Function make-clim-interactor-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>make-clim-interactor-pane</b></td><td valign="baseline" width="100%"><i><tt>&amp;rest</tt> options</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Like <tt>make-clim-stream-pane</tt> , except that the type is forced to be
<tt>interactor-pane</tt> .
<p>
<a name="Function make-clim-application-pane"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>make-clim-application-pane</b></td><td valign="baseline" width="100%"><i><tt>&amp;rest</tt> options</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Like <tt>make-clim-stream-pane</tt> , except that the type is forced to be
<tt>application-pane</tt> .
<p>

<a name="29.4.4"><h3>29.4.4 CLIM Stream Pane Functions</h3></a>
The following functions can be called on any pane that is a subclass of
<tt>clim-stream-pane</tt> .  (Such a pane is often simply referred to as a
<a name="CONCEPT=window"><b><i>window</i></b></a> .)  These are provided purely as a convenience for programmers.
<p>
<a name="Generic function window-clear"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>window-clear</b></td><td valign="baseline" width="100%"><i>window</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Clears the entire drawing plane by filling it with the background design of the
CLIM stream pane <i>window</i> .  If <i>window</i> has an output history, that is
cleared as well.  The text cursor position of <i>window</i> , if there is one, is
reset to the upper left corner.
<p>
<a name="Generic function window-refresh"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>window-refresh</b></td><td valign="baseline" width="100%"><i>window</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Clears the visible part of the drawing plane of the CLIM stream pane
<i>window</i> , and then if the window stream is an output recording stream, the
output records in the visible part of the window are replayed.
<p>
<a name="Generic function window-viewport"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>window-viewport</b></td><td valign="baseline" width="100%"><i>window</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Returns the viewport region of the CLIM stream pane <i>window</i> .  If the window
is not scrollable, and hence has no viewport, this will region <tt>sheet-region</tt> of <i>window</i> .
<p>
The returned region will generally be a <tt>standard-bounding-rectangle</tt> .
<p>
<a name="Generic function window-erase-viewport"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>window-erase-viewport</b></td><td valign="baseline" width="100%"><i>window</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Clears the visible part of the drawing plane of the CLIM stream pane
<i>window</i> by filling it with the background design.
<p>
<a name="Generic function window-viewport-position"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>window-viewport-position</b></td><td valign="baseline" width="100%"><i>window</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Returns two values, the <tt>x</tt> and <tt>y</tt> position of the top-left corner of the CLIM
stream pane <i>window</i> 's viewport.  If the window is not scrollable, this will
return the two values 0 and 0.
<p>
<a name="Generic function (setf* window-viewport-position)"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>(setf* window-viewport-position)</b></td><td valign="baseline" width="100%"><i>x y window</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Generic function]</b></td></tr></table>Sets the position of the CLIM stream pane <i>window</i> 's viewport to <i>x</i> and
<i>y</i> .  If the window is not scrollable, this will do nothing.
<p>
For CLIM implementations that do not support <tt>setf*</tt> , the ``setter'' function
for this is <tt>window-set-viewport-position</tt> .
<p>

<a name="29.4.5"><h3>29.4.5 Creating a Standalone CLIM Window</h3></a>
The following function can be used to create a standalone window that obeys
CLIM's extended input and output stream and output recording protocols.
<p>
<a name="Function open-window-stream"></a><table cellspacing="0" cellpadding="0"><tr valign="baseline"><td nowrap="nowrap" width="0%"><b>open-window-stream</b></td><td valign="baseline" width="100%"><i><tt>&amp;key</tt> port left top right bottom width height
                                  foreground background text-style
                                  (vertical-spacing <tt>2</tt> )
                                  end-of-line-action end-of-page-action
                                  output-record (draw <tt>t</tt> ) (record <tt>t</tt> )
                                  (initial-cursor-visibility <tt>:off</tt> )
                                  text-margin save-under input-buffer
                                  (scroll-bars <tt>:vertical</tt> ) borders label</i></td><td align=right nowrap="nowrap" valign="baseline" width="0%"><b>[Function]</b></td></tr></table>Creates and returns a sheet that can be used as a standalone window that obeys
CLIM's extended input and output stream and output recording protocols.
<p>
The window will be created on the port <i>port</i> at the position specified by
<i>left</i> and <i>top</i> , which default to 0.  <i>right</i> , <i>bottom</i> ,
<i>width</i> , and <i>height</i> default in such a way that the default width will
be 100 and the default height will be 100.
<p>
<i>foreground</i> , <i>background</i> , and <i>text-style</i> are used to specify the
window's default foreground and background inks, and text style.
<i>vertical-spacing</i> , <i>text-margin</i> , <i>end-of-line-action</i> ,
<i>end-of-page-action</i> , <i>output-record</i> , <i>draw</i> , and <i>record</i> are
described in Section <a href="panes.html#LABEL=clim-pane-options"><b><i>CLIM Stream Pane Options</i></b></i></a> .
<p>
<i>scroll-bars</i> specifies whether scroll bars should be included in the
resulting window.  It may be one of <i>nil</i> , <tt>:vertical</tt> (the default),
<tt>:horizontal</tt> , or <tt>:both</tt> .
 
<i>borders</i> is a booleans that specifies whether or not the resulting window
should have a border drawn around it.  The default is <tt>t</tt> .  <i>label</i> is
either <tt>nil</tt> or a string to use as a label for the window.
<p>
<i>initial-cursor-visibility</i> is used to specify whether the window should
have a text cursor.  <tt>:off</tt> (the default) means to make the cursor visible if
the window is waiting for input.  <tt>:on</tt> means to make the cursor visible
immediately.  <tt>nil</tt> means the cursor will not be visible at all.
<p>
When <i>save-under</i> is <a href="panes.html#CONCEPT=true"><i>true</i></a> , the result window will be given a ``bit
save array''.  The default is <tt>nil</tt> .
<p>
If <tt>input-buffer</tt> is supplied, it is an input buffer or event queue to use
for the resulting window.  Programmers will generally supply this when they want
the new window to share its input buffer with an existing application.  The
default is to create a new input buffer.
<p>

<a name="29.5"><h2>29.5 Defining New Pane Types</h2></a>
This section describes how to define new pane classes.  The first section shows
a new kind of leaf pane (an odd kind of push-button).  The second section shows
a new composite pane that draws a dashed border around its contents.
<p>
<a name="29.5.1"><h3>29.5.1 Defining a New Leaf Pane</h3></a>
To define a gadget pane implementation, first define the appearance and layout
behavior of the gadget, then define the callbacks, then define the specific user
interactions that trigger the callbacks.
<p>
For example, to define an odd new kind of button that displays itself as a
circle, and activates whenever the mouse is moved over it, proceed as follows:
<p>
<pre>;; A new kind of button.
(defclass sample-button-pane
          (action-gadget
           space-requirement-mixin
           leaf-pane)
    ())
<p>
;; An arbitrary size parameter.
(defparameter *sample-button-radius* 10)
<p>
;; Define the sheet's repaint method to draw the button.
(defmethod handle-repaint ((button sample-button-pane) region)
  (with-sheet-medium (medium button)
    (let ((radius *sample-button-radius*)
          (half (round  *sample-button-radius* 2)))
      ;; Larger circle with small one in the center
      (draw-circle* medium radius radius radius
                    :filled nil)
      (draw-circle* medium radius radius half
                    :filled t)))
<p>
;; Define the pane's compose-space method to always request the
;; fixed size of the pane.
(defmethod compose-space ((pane sample-button-pane) &key width height)
  (declare (ignore width height))
  (make-space-requirement :width  (* 2 *sample-button-radius*)
                          :height (* 2 *sample-button-radius*)))
</pre> The above code is enough to allow you to instantiate the button pane in an
application frame.  It will fit in with the space composition protocol of, for
example, an <tt>hbox-pane</tt> .  It will display itself as two nested circles.
<p>
The next step is to define the callbacks supported by this gadget, and the user
interaction that triggers them.
<p>
<pre>;; This default method is defined so that the callback can be invoked
;; on an arbitrary client without error.
(defmethod activate-callback
           ((button sample-button-pane) client id)
  (declare (ignore client id value)))
<p>
;; This event processing method defines the rather odd interaction
;; style of this button, to wit, it triggers the activate callback
;; whenever the mouse moves into it.
(defmethod handle-event ((pane sample-button-pane) (event pointer-enter-event))
  (activate-callback pane (gadget-client pane) (gadget-id pane)))
</pre> <a name="29.5.2"><h3>29.5.2 Defining a New Composite Pane</h3></a>
To define a new layout pane implementation, the programmer must define how the
much space the pane takes, where its children go, and what the pane looks like.
<p>
For example, to define a new kind of border pane that draws a dashed border
around its child pane, proceed as follows:
<p>
<pre>;; The new layout pane class.
(defclass dashed-border-pane (layout-pane)
    ((thickness :initform 1 :initarg :thickness))
  (:default-initargs :background +black+))
<p>
;; The specified contents are the sole child of the pane.
(defmethod initialize-instance :after ((pane dashed-border-pane) &key contents)
  (sheet-adopt-child pane contents))
<p>
;; The composite pane takes up all of the space of the child, plus
;; the space required for the border.
(defmethod compose-space ((pane dashed-border-pane) &key width height)
  (let ((thickness (slot-value pane 'thickness))
        (child (sheet-child pane)))
    (space-requirement+
      (compose-space child :width width :height height)
      (make-space-requirement 
        :width (* 2 thickness)
        :height (* 2 thickness)))))
<p>
;; The child pane is positioned just inside the borders.
(defmethod allocate-space ((pane dashed-border-pane) width height)
  (let ((thickness (slot-value pane 'thickness)))
    (move-and-resize-sheet
      (sheet-child pane)
      thickness thickness
      (- width (* 2 thickness)) (- height (* 2 thickness)))))
  
(defmethod handle-repaint ((pane dashed-border-pane) region)
  (declare (ignore region))                     ;not worth checking
  (with-sheet-medium (medium pane)
    (with-bounding-rectangle* (left top right bottom) (sheet-region pane)
      (let ((thickness (slot-value pane 'thickness)))
        (decf right (ceiling thickness 2))
        (decf bottom (ceiling thickness 2))
        (draw-rectangle* medium left top right bottom
                         :line-thickness thickness :filled nil
                         :ink (pane-background pane))))))
<p>
(defmacro dashed-border ((&rest options &key thickness &allow-other-keys)
                         &body contents)
  (declare (ignore thickness))
  `(make-pane 'dashed-border-pane
     :contents ,@contents
     ,@options))
</pre> <br><hr><br><table width=100%><tr valign="baseline">
<td width=25% align=left><a href="frames.html">Application Frames</a></td>
<td width=25% align=center><a href="toc.html">Contents</a></td>
<td width=25% align=center><a href="index.html">Index</a></td>
<td width=25% align=right><a href="gadgets.html">Gadgets</a></td>
</tr></table>
</body></html>
